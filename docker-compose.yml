version: '3.8'

services:
  # 1. Servicio de la Aplicación Python
  app:

    build: .

    ports:
      - "5000:5000"

    volumes:
      - ./app:/usr/src/app
    # Define la red a la que pertenece este servicio.
    networks:
      - python-mongo-network

    depends_on:
      - mongo

  # 2. Servicio de la Base de Datos MongoDB
  mongo:

    image: mongo:latest

    environment:

      MONGO_INITDB_DATABASE: mydatabase
      MONGO_INITDB_ROOT_USERNAME: user
      MONGO_INITDB_ROOT_PASSWORD: password
    ports:
      - "27017:27017"
    volumes:
      - mongo_data:/data/db
    # Define la red a la que pertenece este servicio.
    networks:
      - python-mongo-network

# 3. Definición de Redes y Volúmenes
networks:
  python-mongo-network:
    driver: bridge

volumes:
  mongo_data: